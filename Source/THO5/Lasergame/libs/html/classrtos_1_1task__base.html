<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>V2THDE libraries: rtos::task_base Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">V2THDE libraries
   </div>
   <div id="projectbrief">C++ library for V2THDE</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="classrtos.html">rtos</a></li><li class="navelem"><a class="el" href="classrtos_1_1task__base.html">task_base</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#friends">Friends</a> &#124;
<a href="classrtos_1_1task__base-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">rtos::task_base Class Reference<span class="mlabels"><span class="mlabel">abstract</span></span></div>  </div>
</div><!--header-->
<div class="contents">

<p>an independent thread of execution  
 <a href="classrtos_1_1task__base.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="rtos_8hpp_source.html">rtos.hpp</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for rtos::task_base:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classrtos_1_1task__base.png" usemap="#rtos::task_5Fbase_map" alt=""/>
  <map id="rtos::task_5Fbase_map" name="rtos::task_5Fbase_map">
<area href="classrtos_1_1task.html" alt="rtos::task&lt; N &gt;" shape="rect" coords="0,56,95,80"/>
</map>
 </div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a67892c7e1f734e0a91baa5a4fc6dea27"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classrtos_1_1task__base.html#a67892c7e1f734e0a91baa5a4fc6dea27">main</a> ()=0</td></tr>
<tr class="memdesc:a67892c7e1f734e0a91baa5a4fc6dea27"><td class="mdescLeft">&#160;</td><td class="mdescRight">task body, must be provided by a derived class  <a href="#a67892c7e1f734e0a91baa5a4fc6dea27">More...</a><br /></td></tr>
<tr class="separator:a67892c7e1f734e0a91baa5a4fc6dea27"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7a9351a480725a93f1c2f99451e28e2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classrtos_1_1task__base.html#aa7a9351a480725a93f1c2f99451e28e2">task_base</a> (<a class="el" href="classcoroutine.html">coroutine</a>&lt;&gt; &amp;cor, unsigned int <a class="el" href="classrtos_1_1task__base.html#aec0b6df0ad45e77aefaa170a7a5e4d31">priority</a>=RTOS_MIN_PRIORITY, const char *tname=&quot;&quot;)</td></tr>
<tr class="memdesc:aa7a9351a480725a93f1c2f99451e28e2"><td class="mdescLeft">&#160;</td><td class="mdescRight">constructor, specify priority, name and stack size  <a href="#aa7a9351a480725a93f1c2f99451e28e2">More...</a><br /></td></tr>
<tr class="separator:aa7a9351a480725a93f1c2f99451e28e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8df882df03cd39af4f21609ba1e002e4"><td class="memItemLeft" align="right" valign="top"><a id="a8df882df03cd39af4f21609ba1e002e4"></a>
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classrtos_1_1task__base.html#a8df882df03cd39af4f21609ba1e002e4">~task_base</a> ()</td></tr>
<tr class="memdesc:a8df882df03cd39af4f21609ba1e002e4"><td class="mdescLeft">&#160;</td><td class="mdescRight">throws an error, beacuse tasks should never be destroyed <br /></td></tr>
<tr class="separator:a8df882df03cd39af4f21609ba1e002e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e85c53a3b752218f1ade0126f120c36"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classrtos_1_1task__base.html#a0e85c53a3b752218f1ade0126f120c36">suspend</a> ()</td></tr>
<tr class="memdesc:a0e85c53a3b752218f1ade0126f120c36"><td class="mdescLeft">&#160;</td><td class="mdescRight">suspend a task (prevent execution until a resume)  <a href="#a0e85c53a3b752218f1ade0126f120c36">More...</a><br /></td></tr>
<tr class="separator:a0e85c53a3b752218f1ade0126f120c36"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a024ce327d23412c300a73c4366565c78"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classrtos_1_1task__base.html#a024ce327d23412c300a73c4366565c78">resume</a> ()</td></tr>
<tr class="memdesc:a024ce327d23412c300a73c4366565c78"><td class="mdescLeft">&#160;</td><td class="mdescRight">continue a suspended task  <a href="#a024ce327d23412c300a73c4366565c78">More...</a><br /></td></tr>
<tr class="separator:a024ce327d23412c300a73c4366565c78"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a19952faefc023f605016ff19c46e9124"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classrtos_1_1task__base.html#a19952faefc023f605016ff19c46e9124">release</a> ()</td></tr>
<tr class="memdesc:a19952faefc023f605016ff19c46e9124"><td class="mdescLeft">&#160;</td><td class="mdescRight">release the CPU to the scheduler  <a href="#a19952faefc023f605016ff19c46e9124">More...</a><br /></td></tr>
<tr class="separator:a19952faefc023f605016ff19c46e9124"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16101726a2ed9744face297f9373b632"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classrtos_1_1task__base.html#a16101726a2ed9744face297f9373b632">sleep</a> (unsigned long int time)</td></tr>
<tr class="memdesc:a16101726a2ed9744face297f9373b632"><td class="mdescLeft">&#160;</td><td class="mdescRight">wait for some time  <a href="#a16101726a2ed9744face297f9373b632">More...</a><br /></td></tr>
<tr class="separator:a16101726a2ed9744face297f9373b632"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec0b6df0ad45e77aefaa170a7a5e4d31"><td class="memItemLeft" align="right" valign="top"><a id="aec0b6df0ad45e77aefaa170a7a5e4d31"></a>
unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classrtos_1_1task__base.html#aec0b6df0ad45e77aefaa170a7a5e4d31">priority</a> () const</td></tr>
<tr class="memdesc:aec0b6df0ad45e77aefaa170a7a5e4d31"><td class="mdescLeft">&#160;</td><td class="mdescRight">report the task priority <br /></td></tr>
<tr class="separator:aec0b6df0ad45e77aefaa170a7a5e4d31"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a646c5c7d4804311bf7be79133ae787f3"><td class="memItemLeft" align="right" valign="top"><a id="a646c5c7d4804311bf7be79133ae787f3"></a>
const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classrtos_1_1task__base.html#a646c5c7d4804311bf7be79133ae787f3">name</a> () const</td></tr>
<tr class="memdesc:a646c5c7d4804311bf7be79133ae787f3"><td class="mdescLeft">&#160;</td><td class="mdescRight">report the task name <br /></td></tr>
<tr class="separator:a646c5c7d4804311bf7be79133ae787f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c19d50c67997be35fc6cffbd2562c8d"><td class="memItemLeft" align="right" valign="top"><a id="a0c19d50c67997be35fc6cffbd2562c8d"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classrtos_1_1task__base.html#a0c19d50c67997be35fc6cffbd2562c8d">is_suspended</a> () const</td></tr>
<tr class="memdesc:a0c19d50c67997be35fc6cffbd2562c8d"><td class="mdescLeft">&#160;</td><td class="mdescRight">report whether the task is currently suspended <br /></td></tr>
<tr class="separator:a0c19d50c67997be35fc6cffbd2562c8d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1b392f48bc5c486b12f33f60cbe8194"><td class="memItemLeft" align="right" valign="top"><a id="aa1b392f48bc5c486b12f33f60cbe8194"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classrtos_1_1task__base.html#aa1b392f48bc5c486b12f33f60cbe8194">is_blocked</a> () const</td></tr>
<tr class="memdesc:aa1b392f48bc5c486b12f33f60cbe8194"><td class="mdescLeft">&#160;</td><td class="mdescRight">report whether the task is currently blocked <br /></td></tr>
<tr class="separator:aa1b392f48bc5c486b12f33f60cbe8194"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af175734ed67041c6adec996b45236aa4"><td class="memItemLeft" align="right" valign="top"><a id="af175734ed67041c6adec996b45236aa4"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classrtos_1_1task__base.html#af175734ed67041c6adec996b45236aa4">is_ready</a> () const</td></tr>
<tr class="memdesc:af175734ed67041c6adec996b45236aa4"><td class="mdescLeft">&#160;</td><td class="mdescRight">report whether the task is currently ready for execution <br /></td></tr>
<tr class="separator:af175734ed67041c6adec996b45236aa4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6342ec2926e46637f05dc13be6e0153"><td class="memItemLeft" align="right" valign="top"><a id="ac6342ec2926e46637f05dc13be6e0153"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classrtos_1_1task__base.html#ac6342ec2926e46637f05dc13be6e0153">print</a> (<a class="el" href="classhwlib_1_1ostream.html">hwlib::ostream</a> &amp;stream, bool header=true) const</td></tr>
<tr class="memdesc:ac6342ec2926e46637f05dc13be6e0153"><td class="mdescLeft">&#160;</td><td class="mdescRight">print task statistics <br /></td></tr>
<tr class="separator:ac6342ec2926e46637f05dc13be6e0153"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a32c6e19fe3d25a38587964defdb52ddc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classrtos_1_1event.html">event</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classrtos_1_1task__base.html#a32c6e19fe3d25a38587964defdb52ddc">wait</a> ()</td></tr>
<tr class="memdesc:a32c6e19fe3d25a38587964defdb52ddc"><td class="mdescLeft">&#160;</td><td class="mdescRight">wait for all waitables created for this task  <a href="#a32c6e19fe3d25a38587964defdb52ddc">More...</a><br /></td></tr>
<tr class="separator:a32c6e19fe3d25a38587964defdb52ddc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52035722f108687680966b87dd60bfe1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classrtos_1_1event.html">event</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classrtos_1_1task__base.html#a52035722f108687680966b87dd60bfe1">wait</a> (const <a class="el" href="classrtos_1_1waitable.html">waitable</a> &amp;w)</td></tr>
<tr class="memdesc:a52035722f108687680966b87dd60bfe1"><td class="mdescLeft">&#160;</td><td class="mdescRight">wait for a single waitable  <a href="#a52035722f108687680966b87dd60bfe1">More...</a><br /></td></tr>
<tr class="separator:a52035722f108687680966b87dd60bfe1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6acecfe733161a6258d39ed7a49275d0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classrtos_1_1event.html">event</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classrtos_1_1task__base.html#a6acecfe733161a6258d39ed7a49275d0">wait</a> (const <a class="el" href="classrtos_1_1event.html">event</a> &amp;<a class="el" href="classrtos_1_1task__base.html#a1b3cb75ba2ef779cffc76b6076ecac39">set</a>)</td></tr>
<tr class="memdesc:a6acecfe733161a6258d39ed7a49275d0"><td class="mdescLeft">&#160;</td><td class="mdescRight">wait for a set of waitables  <a href="#a6acecfe733161a6258d39ed7a49275d0">More...</a><br /></td></tr>
<tr class="separator:a6acecfe733161a6258d39ed7a49275d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b3cb75ba2ef779cffc76b6076ecac39"><td class="memItemLeft" align="right" valign="top"><a id="a1b3cb75ba2ef779cffc76b6076ecac39"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classrtos_1_1task__base.html#a1b3cb75ba2ef779cffc76b6076ecac39">set</a> (<a class="el" href="classrtos_1_1flag.html">flag</a> &amp;f)</td></tr>
<tr class="memdesc:a1b3cb75ba2ef779cffc76b6076ecac39"><td class="mdescLeft">&#160;</td><td class="mdescRight">set a flag <br /></td></tr>
<tr class="separator:a1b3cb75ba2ef779cffc76b6076ecac39"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a257d2766179f2b15bf279cf040065472"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classrtos_1_1task__base.html#a257d2766179f2b15bf279cf040065472">ignore_activation_time</a> ()</td></tr>
<tr class="memdesc:a257d2766179f2b15bf279cf040065472"><td class="mdescLeft">&#160;</td><td class="mdescRight">ignore this activation for the statistics  <a href="#a257d2766179f2b15bf279cf040065472">More...</a><br /></td></tr>
<tr class="separator:a257d2766179f2b15bf279cf040065472"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="friends"></a>
Friends</h2></td></tr>
<tr class="memitem:a01d2f5a71b8cd797b5f01fb6940ea353"><td class="memItemLeft" align="right" valign="top"><a id="a01d2f5a71b8cd797b5f01fb6940ea353"></a>
class&#160;</td><td class="memItemRight" valign="bottom"><b>periodic_task</b></td></tr>
<tr class="separator:a01d2f5a71b8cd797b5f01fb6940ea353"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ee29d8961a0b67cea2c3fa76da116da"><td class="memItemLeft" align="right" valign="top"><a id="a0ee29d8961a0b67cea2c3fa76da116da"></a>
class&#160;</td><td class="memItemRight" valign="bottom"><b>waitable_set</b></td></tr>
<tr class="separator:a0ee29d8961a0b67cea2c3fa76da116da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d8be07618a92a592c4905e969f9927f"><td class="memItemLeft" align="right" valign="top"><a id="a2d8be07618a92a592c4905e969f9927f"></a>
class&#160;</td><td class="memItemRight" valign="bottom"><b>flag</b></td></tr>
<tr class="separator:a2d8be07618a92a592c4905e969f9927f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a7bcfc34141352757ad672e3ecd099f"><td class="memItemLeft" align="right" valign="top"><a id="a2a7bcfc34141352757ad672e3ecd099f"></a>
class&#160;</td><td class="memItemRight" valign="bottom"><b>rtos</b></td></tr>
<tr class="separator:a2a7bcfc34141352757ad672e3ecd099f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a376fdffc11fe9fb4f531835b94320825"><td class="memItemLeft" align="right" valign="top"><a id="a376fdffc11fe9fb4f531835b94320825"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>task_trampoline</b> ()</td></tr>
<tr class="separator:a376fdffc11fe9fb4f531835b94320825"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>an independent thread of execution </p>
<p>A task is an independent thread of execution, using its own stack. Tasks share the single CPU, so only one task can be running at any time. The rtos determines which task is running. A task has two bi-value states that determine whether the task is runnable: the suspended/resumed flag and the waiting/non-waiting flag. A task is runnable only when it is both resumed, and non-waiting. When a task is created it is resumed and non-waiting. All tasks (and the rtos code) run in the same memory space, without protection from each other. So a 'wild pointer' in one task can destroy data in another task, or even in the rtos.</p>
<p>Each task is created with a fixed priority, which can be any unsigned integer value below RTOS_MIN_PRIORITY (= 1000). After creation the priority can not be changed. The value 0 indicates the highest task priority, a higher number indicates a lower priority. Each task must have a unique priority, it is an error to create a task with same priority as an existing task. You can omit the priority, in which case the RTOS will select an unused priority starting at RTOS_MIN_PRIORITY (in other words, it will choose a low priority for your task).</p>
<p>Each task has its own stack. You can specify the size of the stack at task creation. If you omit the stack size, RTOS_DEFAULT_STACK_SIZE will be used (default: 8 Kb). This will be enough for most tasks, if you take care not to allocate big things on the stack, and avoid very deep nesting (watch out for recursion!).</p>
<p>A task is created by instatiating a class that derives from <a class="el" href="classrtos_1_1task.html">rtos::task</a> and supplies a <a class="el" href="classrtos_1_1task__base.html#a67892c7e1f734e0a91baa5a4fc6dea27" title="task body, must be provided by a derived class ">main()</a>. This <a class="el" href="classrtos_1_1task__base.html#a67892c7e1f734e0a91baa5a4fc6dea27" title="task body, must be provided by a derived class ">main()</a> should never return. The fragment below shows how you can do this. The task name is used for statistics and debugging. As shown for the name, it might be wise to get the task parameters as arguments to the constructor of your task.</p>
<div class="fragment"><div class="line"><span class="keyword">class </span>my_task_class : <span class="keyword">public</span> <a class="code" href="classrtos_1_1task.html">rtos::task</a> {</div><div class="line"><span class="keyword">public</span>:</div><div class="line">   my_task_class( <span class="keyword">const</span> <span class="keywordtype">char</span> * <a class="code" href="classrtos_1_1task__base.html#a646c5c7d4804311bf7be79133ae787f3">name</a> ):</div><div class="line">      task(</div><div class="line">         name,  <span class="comment">// name of the task</span></div><div class="line">         10,    <span class="comment">// task priority</span></div><div class="line">         16384  <span class="comment">// task stack size</span></div><div class="line">      ){}</div><div class="line"><span class="keyword">private</span>:</div><div class="line">   <span class="keywordtype">void</span> <a class="code" href="classrtos_1_1task__base.html#a67892c7e1f734e0a91baa5a4fc6dea27">main</a>(){</div><div class="line">      <span class="comment">// put the code of your task here</span></div><div class="line">   }</div><div class="line">};</div><div class="line">my_task_class my_task( <span class="stringliteral">&quot;my first task&quot;</span> );</div><div class="line">my_task_class my_task( <span class="stringliteral">&quot;my second task&quot;</span> );</div></div><!-- fragment --><p>The example below is a complete program that shows the standard part (initialization, and a main that calls <a class="el" href="classrtos.html#a981ee019d38e3ccc98bc9102ff641910" title="runs the scheduler ">rtos::run()</a>), a function for writing to an individual LED, a task class that blinks a LED, and two instatiations of this class. Note that the <a class="el" href="classrtos_1_1task__base.html#a16101726a2ed9744face297f9373b632" title="wait for some time ">sleep()</a> call is used instead of mkt_wait_ms or mkt_wait_us. Sleep() causes other tasks to run while this task is waiting, whereas the mkt_wait_* calls would use monopolize the CPU to do a busy wait.</p>
<p>Subsequent examples will not show the standard initialization (the part up to the comment line).</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;rtos.h&quot;</span></div><div class="line"></div><div class="line"><span class="keywordtype">int</span> <a class="code" href="classrtos_1_1task__base.html#a67892c7e1f734e0a91baa5a4fc6dea27">main</a>() {</div><div class="line">   <a class="code" href="classrtos.html#a981ee019d38e3ccc98bc9102ff641910">rtos::run</a>();</div><div class="line">   <span class="keywordflow">return</span> 0;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">// end of standard part</span></div><div class="line"></div><div class="line"><span class="keyword">class </span>blinker : <span class="keyword">public</span> <a class="code" href="classrtos_1_1task.html">rtos::task</a> {</div><div class="line"><span class="keyword">public</span>:</div><div class="line">   blinker( <span class="keywordtype">int</span> LED, <span class="keywordtype">int</span> period ):</div><div class="line">      LED( LED ), period( period ){}</div><div class="line"><span class="keyword">private</span>:</div><div class="line">   <span class="keywordtype">int</span> LED, period;</div><div class="line">   <span class="keywordtype">void</span> <a class="code" href="classrtos_1_1task__base.html#a67892c7e1f734e0a91baa5a4fc6dea27">main</a>(){</div><div class="line">      <span class="keywordflow">for</span>( ; ; ) {</div><div class="line">         led_set( LED, 1 );</div><div class="line">         <a class="code" href="classrtos_1_1task__base.html#a16101726a2ed9744face297f9373b632">sleep</a>( period / 2 );</div><div class="line">         led_set( LED, 0 );</div><div class="line">         <a class="code" href="classrtos_1_1task__base.html#a16101726a2ed9744face297f9373b632">sleep</a>( period / 2 );</div><div class="line">      }</div><div class="line">   }</div><div class="line">};</div><div class="line"></div><div class="line">blinker led0( 0, 1000 MS );</div><div class="line">blinker led1( 1,  300 MS );</div></div><!-- fragment --><p>A task can be suspended and resumed by the <a class="el" href="classrtos_1_1task__base.html#a0e85c53a3b752218f1ade0126f120c36" title="suspend a task (prevent execution until a resume) ">task::suspend()</a> and <a class="el" href="classrtos_1_1task__base.html#a024ce327d23412c300a73c4366565c78" title="continue a suspended task ">task::resume()</a> calls. The suspend/resume state does not count the number of suspends and resumes: a suspend call on an already suspended task (or a resume on an already resumed task) has no effect. Suspend and resume are intended for use by the application code: the rtos will never suspend or resume a task. (The rtos uses the waiting/non-waiting state, which can not be changed directly by the application.)</p>
<p>The example below shows one task that beeps the speaker at 1 kHz, while the other taks suspends and resumes the first task to make it beep 5 times, after which it suspends itself, which ends all activity. (This will trigger the rtos deadlock detection, because a normal embedded application should never terminate.)</p>
<div class="fragment"><div class="line"><span class="keyword">class </span>beeper : <span class="keyword">public</span> <a class="code" href="classrtos_1_1task.html">rtos::task</a> {</div><div class="line"><span class="keyword">public</span>:</div><div class="line">   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> speaker;</div><div class="line">   beeper( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> speaker ): speaker( speaker ){}</div><div class="line">   <span class="keywordtype">void</span> <a class="code" href="classrtos_1_1task__base.html#a67892c7e1f734e0a91baa5a4fc6dea27">main</a>(){</div><div class="line">      mkt_pin_configure( speaker, mkt_output);</div><div class="line">      <span class="keywordflow">for</span>( ; ; ) {</div><div class="line">         mkt_pin_write( speaker, 1  );</div><div class="line">         <a class="code" href="classrtos_1_1task__base.html#a16101726a2ed9744face297f9373b632">sleep</a>( 500 US );</div><div class="line">         mkt_pin_write( speaker, 0  );</div><div class="line">         <a class="code" href="classrtos_1_1task__base.html#a16101726a2ed9744face297f9373b632">sleep</a>( 500 US );</div><div class="line">      }</div><div class="line">   }</div><div class="line">};</div><div class="line">beeper speaker( 10 );</div><div class="line"></div><div class="line"><span class="keyword">class </span>suspender : <span class="keyword">public</span> <a class="code" href="classrtos_1_1task.html">rtos::task</a> {</div><div class="line">   <span class="keywordtype">void</span> <a class="code" href="classrtos_1_1task__base.html#a67892c7e1f734e0a91baa5a4fc6dea27">main</a>(){</div><div class="line">      <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i = 0; i &lt; 5 ; i++ ) {</div><div class="line">         speaker.resume();</div><div class="line">         <a class="code" href="classrtos_1_1task__base.html#a16101726a2ed9744face297f9373b632">sleep</a>( 500 MS );</div><div class="line">         speaker.suspend();</div><div class="line">         <a class="code" href="classrtos_1_1task__base.html#a16101726a2ed9744face297f9373b632">sleep</a>( 1 S );</div><div class="line">      }</div><div class="line">      <a class="code" href="classrtos_1_1task__base.html#a0e85c53a3b752218f1ade0126f120c36">suspend</a>();</div><div class="line">   }</div><div class="line">};</div><div class="line">suspender task2;</div></div><!-- fragment --> </div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="aa7a9351a480725a93f1c2f99451e28e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa7a9351a480725a93f1c2f99451e28e2">&#9670;&nbsp;</a></span>task_base()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">rtos::task_base::task_base </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classcoroutine.html">coroutine</a>&lt;&gt; &amp;&#160;</td>
          <td class="paramname"><em>cor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>priority</em> = <code>RTOS_MIN_PRIORITY</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>tname</em> = <code>&quot;&quot;</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>constructor, specify priority, name and stack size </p>
<p>Priorities are reasonably-valued (below RTOS_MIN_PRIORITY) unsigned integers. 0 is te highest priority. Priorities must be unqiue. The default causes the constructor to choose a free priority starting at RTOS_MIN_PRIORITY (default: 1000).</p>
<p>The name is used for debugging and statistics.</p>
<p>A stack of stack_size bytes is allocated for the task. The default is 4 kB. </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a257d2766179f2b15bf279cf040065472"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a257d2766179f2b15bf279cf040065472">&#9670;&nbsp;</a></span>ignore_activation_time()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void rtos::task_base::ignore_activation_time </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>ignore this activation for the statistics </p>
<p>Calling this function makes the rtos statistics ignore the current task activation as far as statistics is concerned. You can use this to avoid pullution of your task statistics with the timing effects of debug logging. But make sure you don't use it in the 'normal' execution paths, because that would make the statistics lie to you. </p>

</div>
</div>
<a id="a67892c7e1f734e0a91baa5a4fc6dea27"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a67892c7e1f734e0a91baa5a4fc6dea27">&#9670;&nbsp;</a></span>main()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void rtos::task_base::main </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>task body, must be provided by a derived class </p>
<p>A task is created by inheriting from task and providing a <a class="el" href="classrtos_1_1task__base.html#a67892c7e1f734e0a91baa5a4fc6dea27" title="task body, must be provided by a derived class ">main()</a> function. Initialisation of the task, including creating its waitables, should be done in the constructor. Don't forget to call the constructor of the task class!</p>
<p>The <a class="el" href="classrtos_1_1task__base.html#a67892c7e1f734e0a91baa5a4fc6dea27" title="task body, must be provided by a derived class ">main()</a> is the body of the task. It should never terminate.</p>
<p>Each task has a unique priority (an unsigned integer). A lower value indicates a higher priority. The rtos scheduler will always run the task with the higest-priority runnable (neither blocked nor suspended) task. A task runs until it changes this 'situation' by using an rtos call that changes its own state to not runnable, or the state of a higher priority task to runnable.</p>
<p>Timers are served only when the rtos is activated by calling any of its state-changing interfaces. Hence the longest run time between such calls determines the granularity (time wise responsiveness) of the application. Within a time consuming computation a task can call <a class="el" href="classrtos_1_1task__base.html#a19952faefc023f605016ff19c46e9124" title="release the CPU to the scheduler ">release()</a> to have the rtos serve the timers. </p>

</div>
</div>
<a id="a19952faefc023f605016ff19c46e9124"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a19952faefc023f605016ff19c46e9124">&#9670;&nbsp;</a></span>release()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rtos::task_base::release </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>release the CPU to the scheduler </p>
<p>Sevices timers and releases the CPU to a higher priority task if is ready. </p>

</div>
</div>
<a id="a024ce327d23412c300a73c4366565c78"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a024ce327d23412c300a73c4366565c78">&#9670;&nbsp;</a></span>resume()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void rtos::task_base::resume </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>continue a suspended task </p>
<p>Has no effect when the task is not suspended.</p>
<p>Can be extended by an application task to suit its needs. </p>

</div>
</div>
<a id="a16101726a2ed9744face297f9373b632"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a16101726a2ed9744face297f9373b632">&#9670;&nbsp;</a></span>sleep()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rtos::task_base::sleep </td>
          <td>(</td>
          <td class="paramtype">unsigned long int&#160;</td>
          <td class="paramname"><em>time</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>wait for some time </p>
<p>Sleeps the task (prevents execution) for the indicated time. </p>

</div>
</div>
<a id="a0e85c53a3b752218f1ade0126f120c36"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e85c53a3b752218f1ade0126f120c36">&#9670;&nbsp;</a></span>suspend()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void rtos::task_base::suspend </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>suspend a task (prevent execution until a resume) </p>
<p>Suspends the task (prevents execution). Has no effect when the task is already suspended. Can be extended by an application task.</p>
<p>A concrete task can extend this operation to suit its needs. </p>

</div>
</div>
<a id="a32c6e19fe3d25a38587964defdb52ddc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a32c6e19fe3d25a38587964defdb52ddc">&#9670;&nbsp;</a></span>wait() <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classrtos_1_1event.html">event</a> rtos::task_base::wait </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>wait for all waitables created for this task </p>
<p>Wait (prevent execution) until at least one of the waitables is set. Return and clear that waitable. Three variants for the parameter:</p>
<ul>
<li>The default (no parameter) waits for all waitables defined for the task.</li>
<li>One waitable as argument waits for that specific waitable.</li>
<li>The addition (operator+) of waitables: wait for any one of those waitables.</li>
</ul>
<p>It is an error to wait for waitables that have not been created for this task. </p>

</div>
</div>
<a id="a52035722f108687680966b87dd60bfe1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a52035722f108687680966b87dd60bfe1">&#9670;&nbsp;</a></span>wait() <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classrtos_1_1event.html">event</a> rtos::task_base::wait </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classrtos_1_1waitable.html">waitable</a> &amp;&#160;</td>
          <td class="paramname"><em>w</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>wait for a single waitable </p>
<p>Wait (prevent execution) until at least one of the waitables is set. Return and clear that waitable. Three variants for the parameter:</p>
<ul>
<li>The default (no parameter) waits for all waitables defined for the task.</li>
<li>One waitable as argument waits for that specific waitable.</li>
<li>The addition (operator+) of waitables: wait for any one of those waitables.</li>
</ul>
<p>It is an error to wait for waitables that have not been created for this task. </p>

</div>
</div>
<a id="a6acecfe733161a6258d39ed7a49275d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6acecfe733161a6258d39ed7a49275d0">&#9670;&nbsp;</a></span>wait() <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classrtos_1_1event.html">event</a> rtos::task_base::wait </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classrtos_1_1event.html">event</a> &amp;&#160;</td>
          <td class="paramname"><em>set</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>wait for a set of waitables </p>
<p>Wait (prevent execution) until at least one of the waitables is set. Return and clear that waitable. Three variants for the parameter:</p>
<ul>
<li>The default (no parameter) waits for all waitables defined for the task.</li>
<li>One waitable as argument waits for that specific waitable.</li>
<li>The addition (operator+) of waitables: wait for any one of those waitables.</li>
</ul>
<p>It is an error to wait for waitables that have not been created for this task. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="rtos_8hpp_source.html">rtos.hpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Jun 29 2017 16:30:24 for V2THDE libraries by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
